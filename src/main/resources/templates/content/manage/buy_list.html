<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{layout/manage_layout}">

<div layout:fragment ="content">

	<style>
		.star {
			position: relative;
			font-size: 2rem;
			color: #ddd;
		}
	  
		.star input {
			width: 100%;
			height: 100%;
			position: absolute;
			left: 0;
			opacity: 0;
			cursor: pointer;
		}

		.star span {
			width: 0;
			position: absolute; 
			left: 0;
			color: #CFB997;
			overflow: hidden;
			pointer-events: none;
		}
	</style>
	
	<div class="mt-3">

		<div>
			
			<div class="col text-center">
				<table class="table">
					<colgroup>
						<col width="20%">
						<col width="10%">
						<col width="*">
						<col width="10%">
						<col width="15%">
						<col width="20%">
					</colgroup>
					<thead>
						<tr>
							<th scope="col">
								<div>주문일자</div>
								<div>[주문번호]</div>
							</th>
							<th scope="col" colspan="2">상품정보</th>
							<th scope="col">금액</th>
							<th scope="col">주문상태</th>
							<th scope="col">구매확정/리뷰작성</th>
						</tr>
					</thead>
					<tbody>
						<th:block th:if="${#lists.size(buyList) == 0}">
							<tr>
								<td colspan="6">주문 내역이 없습니다.</td>
							</tr>
						</th:block>
						<th:block th:unless="${#lists.size(buyList) == 0}">
							<tr th:each="buy : ${buyList}">
								<td>
									<div>[[${buy.buyDate}]]</div>
									<div><span>[</span>[[${buy.buyCode}]]<span>]</span></div>
								</td>
								<td class="text-end">
									<img th:src="|@{/images/}${buy.imgList[0].attachedName}|" height="100px;">
								</td>
								<td class="text-start" th:text="${buy.itemVO.itemName}"
									th:data-item-code="${buy.itemVO.itemName}" id="itemName"></td>
								<td th:text="${#numbers.formatCurrency(buy.itemVO.itemPrice)}"></td>
								<td></td>
								<td>
									<input type="button" value="구매 확정">
									<input type="hidden" th:value="${buy.itemVO.itemCode}" id="hiddenItemCode">
									<!-- <input type="hidden" th:value="${buy.itemVO.itemName}" id="hiddenItemName"> -->
									<input type="button" value="후기 작성" th:onclick="regReview(this);" >
								</td>
							</tr>
						</th:block>
						
					</tbody>
				</table>
			</div>
		</div>
		
		
		
	</div>

	<!-- 후기 작성 버튼 클릭시 실행되는 Modal -->
	<div class="modal fade" id="review_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">리뷰 작성</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<form class="row g-3" th:action="@{/board/regReview}" method="post" enctype="multipart/form-data">
							<div class="col-12">
								<div class="mt-3">
									상품명 | <span id="modalItemName"></span>
									<input type="text" name="itemCode" value="" id="modalItemCode">
								</div>
								<div class="mt-3"> 별점 | 
									<span class="star">
										★★★★★
										<span>★★★★★</span>
										<input type="range" oninput="drawStar(this)" value="1" step="1" min="0" max="10" name="starPoint">
									</span>
								</div>
							
								<div class="mt-3">
									<input type="text" class="form-control" name="boardTitle" placeholder="제목을 입력하세요">
								</div>
								<div class="mt-3">
									<textarea rows="10px;" class="form-control" name="boardContent" placeholder="내용을 입력하세요"></textarea>
								</div>
								<div class="mt-3">
									<input class="form-control" type="file" name="reviewImg">
								</div>
							</div>
							<div class="col-12 text-end">
								<button type="button" class="btn btn-secondary"	data-bs-dismiss="modal">Close</button>
								<button type="submit" class="btn btn-primary">등록</button>
							</div>
						</form>
					</div>
				<!-- 	<div class="modal-footer">
					
					</div> -->
			</div>
		</div>
	</div>	

	<script type="text/javascript">
		 const drawStar = (target) => {
			    document.querySelector(`.star span`).style.width = `${target.value * 10}%`;
			  }
	</script>

	<script type="text/javascript" th:src="@{/js/buy/buy_list.js}"></script>



</div>
</html>
