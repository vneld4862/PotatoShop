<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
   layout:decorate="~{layout/admin_layout}">

<div layout:fragment ="content">
	<style>
		.msg {
			margin-top: -15px;
			font-weight: bold;
			color: #CFB997;
			font-size: 14px;
		}
	</style>

	<div class="col-10" style="margin: 0 auto;">
		<div class="col">
			<div class="text-end">
				<form th:action="@{/admin/memberManage}" method="post">
					<select name="searchType" style="width: 10%; height: 30px; font-family: 'Cafe24SsurroundAir'">
						<option value="MEMBER_NICKNAME" th:selected="${memberVO.searchType == 'MEMBER_NICKNAME'}">닉네임</option>
						<option value="MEMBER_ID" th:selected="${memberVO.searchType == 'MEMBER_ID'}">아이디</option>
					</select>
					<input type="text" name="searchValue" th:value="${memberVO.searchValue}" class="" style="width: 20%">
					<input type="submit" value="검색" class="btn btn-success" style="width: 5%">
				</form>
			</div>
		</div>
		<div class="col mb-3">
			<div class="col mb-3 text-center">
				<h4>MEMBER LIST</h4>
			</div>
			<div class="col text-start">
				<select class="mb-3 text-start" onchange="changeStatus();"
						id="statusSelectBox" style="width: 10%; height: 30px; font-family: 'Cafe24SsurroundAir';">
					<option value="ALL">전체</option>
					<option value="ACTIVE">활동 중인 회원</option>
					<option value="DELETED">탈퇴한 회원</option>
				</select>
			</div>
			
			<div class="msg mb-3 text-end">
				*회원 닉네임 클릭시 상세 정보 조회 가능
			</div>
				
			<div class="col" style="padding-right: 15px;">
				<table class="table text-center">
					<colgroup>
						<col width="10%">
						<col width="*">
						<col width="20%">
						<col width="20%">
						<col width="20%">
					</colgroup>
					<thead>
						<tr>
							<th scope="col">No</th>
							<th scope="col">닉네임(ID)</th>
							<th scope="col">등급</th>
							<th scope="col">가입일</th>
							<th scope="col">상태</th>
						</tr>
					</thead>
				</table>
			</div>

			<div class="col">
				<div class="row" style="height: 300px; overflow-y: scroll;">
					<table class="table text-center memberListTable">
						<colgroup>
							<col width="10%">
							<col width="*">
							<col width="20%">
							<col width="20%">
							<col width="20%">
						</colgroup>
						<tbody>
							<th:block th:if="${#lists.size(memberList) == 0}">
								<tr>
									<td colspan="5">회원이 없습니다.</td>
								</tr>
							</th:block>
							<th:block th:unless="${#lists.size(memberList) == 0}">
								<tr th:each="member : ${memberList}">
									<td th:text="${memberStat.count}">
										<input type="hidden" th:value="${#authentication.name}" id="hiddenId">
									</td>
									<td th:onclick="getMemberDetail([[${member.memberId}]]);">[[${member.memberNickName}]]([[${member.memberId}]])</td>
									<td>등급</td>
									<td th:text="${member.regDate}"></td>
									<td>
										<div class="form-check form-check-inline">
											<input class="form-check-input" type="radio"
												th:name="|test_${memberStat.count}|" id="" value=""
												th:checked="${member.memberStatus eq 'ACTIVE'}"
												th:onclick="changeMemberStatus([[${member.memberId}]], 'ACTIVE');">
											<label class="form-check-label" for="">활동 중</label>
										</div>
										<div class="form-check form-check-inline">
											<input class="form-check-input" type="radio"
												th:name="|test_${memberStat.count}|" id="" value=""
												th:checked="${member.memberStatus eq 'DELETED'}"
												th:onclick="changeMemberStatus([[${member.memberId}]], 'DELETED');">
											<label class="form-check-label" for="">탈퇴</label>
										</div>
									</td>
								</tr>
							</th:block>
						</tbody>
					</table>
				</div>
				

				
			</div>
		</div>
		
		
		
		<div class="row mt-3">
			<div class="col" id="detailDiv">
				<div class="row">
					<div class="mb-3">
						<회원 상세 정보>
					</div>
				</div>
			</div>
			
			<div class="col" id="reviewDiv">
				<div class="row">
					<div class="mb-3">
						<다른 상점에 남긴 후기>
					</div>
				</div>

			</div>
		</div>
	
	</div>
	
	
	<!-- 리뷰 제목 클릭시 실행되는 Modal -->
	<div class="modal fade" id="reviewDetailModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
			 	<div class="modal-header">
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div> 
				<div class="modal-body">
				
					<div class="col-12 detailAjaxDiv">

					</div>
						
					<div class="row replyDiv"> <!-- 댓글 등록 -->
						<div class="col-12">
							<div class="row">
								<div class="col-12">
									<input type="hidden" name="itemCode" value="" id="replyItemCode">
									<input type="hidden" name="memberId" th:value="${#authentication.name}"> 
								</div>
								<div class="col-10">
									<textarea rows="2" name="replyContent" id="replyContent" style="resize: none;" class="form-control"></textarea>
								</div>
								<div class="col-2">
									<input type="button" onclick="regReply();" class="btn btn-primary" value="등록" style="height: 62px; width: 100%;">
								</div>
							</div>
						</div>
					</div>
				

					<hr>
					
					<div class="col-12 replyListDiv">
						<!-- 댓글 목록 -->
					</div>

				</div>
				
			</div>
		</div>
	</div>
	
	
	
	<!-- 리뷰 수정 버튼 클릭시 실행되는 Modal -->
	<div class="modal fade" id="review_update_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">리뷰 수정</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<form class="row g-3" th:action="@{/board/updateReview}" method="post"> <!-- enctype="multipart/form-data" -->

							<div class="col-12 updateReviewAjaxDiv">
							
								<!-- Ajax로 그려 줌 -->
								
							</div>

							<div class="col-12 text-end">
								<button type="button" class="btn btn-secondary"	data-bs-dismiss="modal">Close</button>
								<button type="submit" class="btn btn-primary">수정</button>
							</div>
						</form>
					</div>
				<!-- 	<div class="modal-footer">
					
					</div> -->
			</div>
		</div>
	</div>	

	<script type="text/javascript">
		 const drawStar = (target) => {
			    document.querySelector(`.star span`).style.width = `${target.value * 10}%`;
			  }
	</script>
	
	<script type="text/javascript" th:src="@{/js/admin/member_manage.js}"></script>
	<script type="text/javascript" th:src="@{/js/manage/my_market.js}"></script>

</div>
</html>
